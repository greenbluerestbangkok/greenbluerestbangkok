(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{4326:function(e,a,s){Promise.resolve().then(s.bind(s,2046))},2046:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return i}});var t=s(7437),l=s(2265),r=s(7648);function i(){let[e,a]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[n,c]=(0,l.useState)(null),[d,o]=(0,l.useState)(""),[m,x]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[u,g]=(0,l.useState)({page:1,limit:20,total:0,totalPages:0}),j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{i(!0);let s=new URLSearchParams({page:e.toString(),limit:"20",...d&&{search:d},...m&&{category:m},...h&&{status:h}}),t=await fetch("/admin/api/operators?".concat(s)),l=await t.json();if(!t.ok)throw Error(l.error||"Failed to fetch operators");a(l.operators),g(l.pagination),c(null)}catch(e){c(e instanceof Error?e.message:"Failed to fetch operators")}finally{i(!1)}};(0,l.useEffect)(()=>{j()},[d,m,h]);let b=async(e,a)=>{if(confirm('คุณต้องการลบผู้ประกอบการ "'.concat(a,'" หรือไม่?')))try{let a=await fetch("/admin/api/operators/".concat(e),{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to delete operator")}j(u.page)}catch(e){alert(e instanceof Error?e.message:"Failed to delete operator")}},v=async(e,a)=>{try{let s=await fetch("/admin/api/operators/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"active"===a?"inactive":"active"})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update operator status")}j(u.page)}catch(e){alert(e instanceof Error?e.message:"Failed to update operator status")}};return s?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"spinner"})})}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"จัดการผู้ประกอบการ"}),(0,t.jsx)("p",{className:"text-gray-600",children:"จัดการข้อมูลผู้ประกอบการในชุมชนทั้งหมด"})]}),(0,t.jsx)(r.default,{href:"/admin/operators/new",className:"btn-primary",children:"เพิ่มผู้ประกอบการใหม่"})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"form-label",children:"ค้นหาผู้ประกอบการ"}),(0,t.jsx)("input",{type:"text",placeholder:"ค้นหาตามชื่อ, คำอธิบาย หรือประเภท...",value:d,onChange:e=>o(e.target.value),className:"form-input"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"form-label",children:"ประเภท"}),(0,t.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"form-input",children:[(0,t.jsx)("option",{value:"",children:"ทุกประเภท"}),(0,t.jsx)("option",{value:"farm",children:"ฟาร์ม"}),(0,t.jsx)("option",{value:"craft",children:"งานฝีมือ"}),(0,t.jsx)("option",{value:"restaurant",children:"ร้านอาหาร"}),(0,t.jsx)("option",{value:"market",children:"ตลาด"}),(0,t.jsx)("option",{value:"art",children:"ศิลปะ"}),(0,t.jsx)("option",{value:"education",children:"การศึกษา"}),(0,t.jsx)("option",{value:"tourism",children:"ท่องเที่ยว"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"form-label",children:"สถานะ"}),(0,t.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"form-input",children:[(0,t.jsx)("option",{value:"",children:"ทุกสถานะ"}),(0,t.jsx)("option",{value:"active",children:"เปิดใช้งาน"}),(0,t.jsx)("option",{value:"inactive",children:"ปิดใช้งาน"})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)("button",{onClick:()=>j(1),className:"btn-secondary w-full",children:"ค้นหา"})})]})}),n&&(0,t.jsx)("div",{className:"alert alert-error mb-6",children:n}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===e.length?(0,t.jsxs)("div",{className:"col-span-full bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDC65"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่พบผู้ประกอบการ"}),(0,t.jsx)("p",{className:"text-gray-500",children:"ลองปรับเปลี่ยนเงื่อนไขการค้นหา"})]}):e.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:[e.image&&(0,t.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-200",children:(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-48 object-cover"})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:e.name}),(0,t.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,t.jsx)("span",{className:"badge badge-info",children:e.type}),e.featured&&(0,t.jsx)("span",{className:"badge badge-warning",children:"แนะนำ"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3",children:e.description}),(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("span",{className:"badge ".concat("active"===e.status?"badge-success":"badge-error"),children:"active"===e.status?"เปิดใช้งาน":"ปิดใช้งาน"})}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 mb-4",children:[e.phone&&(0,t.jsxs)("p",{children:["\uD83D\uDCDE ",e.phone]}),e.email&&(0,t.jsxs)("p",{children:["\uD83D\uDCE7 ",e.email]}),e.address&&(0,t.jsxs)("p",{children:["\uD83D\uDCCD ",e.address]})]}),e.activities.length>0&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"กิจกรรม:"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.activities.slice(0,3).map((e,a)=>(0,t.jsx)("span",{className:"badge badge-secondary text-xs",children:e},a)),e.activities.length>3&&(0,t.jsxs)("span",{className:"badge badge-secondary text-xs",children:["+",e.activities.length-3]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(r.default,{href:"/admin/operators/".concat(e.id),className:"flex-1 btn-primary text-center text-sm py-2",children:"แก้ไข"}),(0,t.jsx)("button",{onClick:()=>v(e.id,e.status),className:"px-3 py-2 text-sm rounded-md ".concat("active"===e.status?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:"active"===e.status?"ปิดใช้งาน":"เปิดใช้งาน"}),(0,t.jsx)("button",{onClick:()=>b(e.id,e.name),className:"px-3 py-2 text-sm text-red-600 hover:text-red-800",children:"ลบ"})]})]})]},e.id))}),u.totalPages>1&&(0,t.jsx)("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6 mt-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-700",children:["แสดง ",(u.page-1)*u.limit+1," ถึง"," ",Math.min(u.page*u.limit,u.total)," จาก"," ",u.total," รายการ"]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>j(u.page-1),disabled:1===u.page,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"ก่อนหน้า"}),(0,t.jsxs)("span",{className:"px-3 py-2 text-sm text-gray-700",children:["หน้า ",u.page," จาก ",u.totalPages]}),(0,t.jsx)("button",{onClick:()=>j(u.page+1),disabled:u.page===u.totalPages,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"ถัดไป"})]})]})})]})}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=4326)}),_N_E=e.O()}]);