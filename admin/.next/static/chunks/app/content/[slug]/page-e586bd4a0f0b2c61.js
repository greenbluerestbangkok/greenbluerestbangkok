(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{7336:function(e,t,a){Promise.resolve().then(a.bind(a,8824))},8824:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var s=a(7437),n=a(2265),o=a(9376),r=a(7648);function d(){let e=(0,o.useRouter)(),t=(0,o.useParams)().slug,[a,d]=(0,n.useState)(null),[i,l]=(0,n.useState)(!0),[c,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[y,f]=(0,n.useState)({title:"",date:"",tags:"",status:"draft",cover:"",body:""}),[b,p]=(0,n.useState)({content:""});(0,n.useEffect)(()=>{t&&v()},[t]);let v=async()=>{try{l(!0),h("");let a="/content/".concat(t),s=await fetch("/admin/api/content/get?path=".concat(encodeURIComponent(a)));if(!s.ok){if(404===s.status)throw Error("Content not found");throw Error("Failed to load content")}let n=await s.json();if(d(n),"md"===n.type){var e;f({title:n.frontmatter.title||"",date:n.frontmatter.date||"",tags:(null===(e=n.frontmatter.tags)||void 0===e?void 0:e.join(", "))||"",status:n.frontmatter.status||"draft",cover:n.frontmatter.cover||"",body:n.body||""})}else"json"===n.type&&p({content:JSON.stringify(n.json,null,2)})}catch(e){h(e instanceof Error?e.message:"Failed to load content")}finally{l(!1)}},j=async e=>{if(e.preventDefault(),a&&"md"===a.type){m(!0),h(""),g("");try{let e=y.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0),s={type:"md",path:"/content/".concat(t),sha:a.sha,frontmatter:{title:y.title,date:y.date,tags:e,status:y.status,cover:y.cover||void 0},body:y.body},n=await fetch("/admin/api/content/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to save content")}await n.json(),g("Content saved successfully!"),setTimeout(()=>{v(),g("")},1500)}catch(e){h(e instanceof Error?e.message:"Failed to save content")}finally{m(!1)}}},N=async e=>{if(e.preventDefault(),a&&"json"===a.type){m(!0),h(""),g("");try{let e;try{e=JSON.parse(b.content)}catch(e){throw Error("Invalid JSON format")}let s={type:"json",path:"/content/".concat(t),sha:a.sha,json:e},n=await fetch("/admin/api/content/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to save content")}await n.json(),g("Content saved successfully!"),setTimeout(()=>{v(),g("")},1500)}catch(e){h(e instanceof Error?e.message:"Failed to save content")}finally{m(!1)}}},w=async()=>{if(a&&confirm("Are you sure you want to delete this content? This action cannot be undone."))try{m(!0);let s=await fetch("/admin/api/content/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:"/content/".concat(t),sha:a.sha})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to delete content")}e.push("/admin/content")}catch(e){h(e instanceof Error?e.message:"Failed to delete content"),m(!1)}},C=async()=>{if(!a||"md"!==a.type)return;let e="draft"===y.status?"published":"draft";f(t=>({...t,status:e}));try{let s=y.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0),n={type:"md",path:"/content/".concat(t),sha:a.sha,frontmatter:{...y,status:e,tags:s},body:y.body};(await fetch("/admin/api/content/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok&&(g("Content ".concat(e," successfully!")),setTimeout(()=>{v(),g("")},1500))}catch(e){h("Failed to update status"),f(e=>({...e,status:y.status}))}},S=(e=>{try{return JSON.parse(e),{valid:!0,error:null}}catch(e){return{valid:!1,error:e instanceof Error?e.message:"Invalid JSON"}}})(b.content);return i?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading content..."})]})}):u&&!a?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,s.jsx)(r.default,{href:"/admin/content",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Back to Content"})]})}):a?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Content"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["md"===a.type?"\uD83D\uDCDD":"\uD83D\uDCC4"," /content/",t]})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:["md"===a.type&&(0,s.jsx)("button",{onClick:C,disabled:c,className:"px-4 py-2 rounded-md text-sm font-medium ".concat("published"===y.status?"bg-green-100 text-green-800 hover:bg-green-200":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"," disabled:opacity-50"),children:"published"===y.status?"Unpublish":"Publish"}),(0,s.jsx)("button",{onClick:w,disabled:c,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Delete"}),(0,s.jsx)(r.default,{href:"/admin/content",className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Back to Content"})]})]})})}),(0,s.jsx)("main",{className:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[u&&(0,s.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:u}),x&&(0,s.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:x}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,s.jsx)("div",{className:"p-6",children:"md"===a.type?(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"md-title",className:"block text-sm font-medium text-gray-700",children:"Title"}),(0,s.jsx)("input",{type:"text",id:"md-title",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:y.title,onChange:e=>f(t=>({...t,title:e.target.value})),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"md-date",className:"block text-sm font-medium text-gray-700",children:"Date"}),(0,s.jsx)("input",{type:"date",id:"md-date",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:y.date,onChange:e=>f(t=>({...t,date:e.target.value})),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"md-tags",className:"block text-sm font-medium text-gray-700",children:"Tags (comma-separated)"}),(0,s.jsx)("input",{type:"text",id:"md-tags",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:y.tags,onChange:e=>f(t=>({...t,tags:e.target.value}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"md-cover",className:"block text-sm font-medium text-gray-700",children:"Cover Image URL"}),(0,s.jsx)("input",{type:"url",id:"md-cover",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:y.cover,onChange:e=>f(t=>({...t,cover:e.target.value}))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"md-body",className:"block text-sm font-medium text-gray-700",children:"Content"}),(0,s.jsx)("textarea",{id:"md-body",rows:15,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:y.body,onChange:e=>f(t=>({...t,body:e.target.value})),required:!0})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(r.default,{href:"/admin/content",className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:c?"Saving...":"Save Changes"})]})]}):(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"json-content",className:"block text-sm font-medium text-gray-700",children:"JSON Content"}),(0,s.jsx)("textarea",{id:"json-content",rows:20,className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 font-mono text-sm ".concat(S.valid?"border-gray-300":"border-red-300"),value:b.content,onChange:e=>p(t=>({...t,content:e.target.value})),required:!0}),!S.valid&&(0,s.jsxs)("p",{className:"mt-2 text-sm text-red-600",children:["Invalid JSON: ",S.error]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(r.default,{href:"/admin/content",className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c||!S.valid,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:c?"Saving...":"Save Changes"})]})]})})})]})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Content Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"The requested content could not be found."}),(0,s.jsx)(r.default,{href:"/admin/content",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Back to Content"})]})})}},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=7336)}),_N_E=e.O()}]);