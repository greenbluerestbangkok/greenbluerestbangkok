(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[990],{549:function(e,t,s){Promise.resolve().then(s.bind(s,2932))},2932:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),r=s(2265),l=s(9376),d=s(7648);function i(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[n,c]=(0,r.useState)(!0),[o,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(""),[u,g]=(0,r.useState)(""),[p,f]=(0,r.useState)("grid"),[b,y]=(0,r.useState)(""),[j,v]=(0,r.useState)(null),[N,w]=(0,r.useState)(!1),[D,C]=(0,r.useState)({}),E=(0,r.useRef)(null);(0,l.useRouter)(),(0,r.useEffect)(()=>{S()},[]),(0,r.useEffect)(()=>{k()},[e,b]);let S=async()=>{try{c(!0);let e=await fetch("/admin/api/media/list?recursive=true&limit=100");if(!e.ok)throw Error("Failed to load media");let s=await e.json();t(s.files)}catch(e){h(e instanceof Error?e.message:"Failed to load media")}finally{c(!1)}},k=()=>{let t=e;b&&(t=t.filter(e=>e.path.includes(b))),i(t)},F=e=>{var t;return(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""},P=e=>["jpg","jpeg","png","webp","gif"].includes(F(e)),T=async e=>{try{await navigator.clipboard.writeText(e),g("Path copied to clipboard!"),setTimeout(()=>g(""),2e3)}catch(e){h("Failed to copy to clipboard")}},L=async(e,t)=>{try{if(!(await fetch("/admin/api/media/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,sha:t})})).ok)throw Error("Failed to delete media");await S(),v(null),g("Media deleted successfully!"),setTimeout(()=>g(""),3e3)}catch(e){h(e instanceof Error?e.message:"Failed to delete media")}},M=async e=>{if(0===e.length)return;m(!0),h(""),g("");let t=new FormData;Array.from(e).forEach(e=>{t.append("files",e)});try{let e=await fetch("/admin/api/media/upload",{method:"POST",body:t}),s=await e.json();if(s.success&&(g("".concat(s.uploaded.length," files uploaded successfully!")),await S()),s.errors.length>0){let e=s.errors.map(e=>"".concat(e.name,": ").concat(e.error)).join(", ");h("Some files failed to upload: ".concat(e))}}catch(e){h(e instanceof Error?e.message:"Upload failed")}finally{m(!1)}},_=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?w(!0):"dragleave"===e.type&&w(!1)},O=()=>{var e;null===(e=E.current)||void 0===e||e.click()};return n?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading media..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Media Library"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Manage your media files"})]}),(0,a.jsx)("div",{className:"flex space-x-4",children:(0,a.jsx)(d.default,{href:"/admin",className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Dashboard"})})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[x&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:x}),u&&(0,a.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:u}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,a.jsx)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(N?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"),onDragEnter:_,onDragLeave:_,onDragOver:_,onDrop:e=>{e.preventDefault(),e.stopPropagation(),w(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&M(e.dataTransfer.files)},children:o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Uploading files..."})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-6xl text-gray-400",children:"\uD83D\uDCC1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Media Files"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Drag and drop files here, or click to select files"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Supports PNG, JPEG, WebP images up to 8MB"})]}),(0,a.jsx)("button",{onClick:O,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Select Files"}),(0,a.jsx)("input",{ref:E,type:"file",multiple:!0,accept:"image/*",onChange:e=>{e.target.files&&e.target.files.length>0&&M(e.target.files)},className:"hidden"})]})})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"View:"}),(0,a.jsxs)("div",{className:"flex rounded-md shadow-sm",children:[(0,a.jsx)("button",{onClick:()=>f("grid"),className:"px-3 py-2 text-sm font-medium rounded-l-md ".concat("grid"===p?"bg-indigo-600 text-white":"bg-white text-gray-700 border border-gray-300"),children:"Grid"}),(0,a.jsx)("button",{onClick:()=>f("list"),className:"px-3 py-2 text-sm font-medium rounded-r-md border-t border-r border-b ".concat("list"===p?"bg-indigo-600 text-white":"bg-white text-gray-700 border-gray-300"),children:"List"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("label",{htmlFor:"monthFilter",className:"text-sm font-medium text-gray-700",children:"Filter by month:"}),(0,a.jsxs)("select",{id:"monthFilter",className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",value:b,onChange:e=>y(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"All months"}),(()=>{let t=new Set;return e.forEach(e=>{let s=e.path.match(/\/images\/(\d{4})\/(\d{2})\//);s&&t.add("".concat(s[1],"-").concat(s[2]))}),Array.from(t).sort().reverse()})().map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",s.length," of ",e.length," files"]})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:0===s.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDDBC️"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No media found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:b?"No media files found for the selected month":"Upload some images to get started"}),(0,a.jsx)("button",{onClick:O,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Upload Files"})]}):(0,a.jsx)("div",{className:"p-6 ".concat("grid"===p?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-6":"space-y-4"),children:s.map((e,t)=>(0,a.jsx)("div",{className:"".concat("grid"===p?"bg-gray-50 rounded-lg overflow-hidden hover:shadow-md transition-shadow":"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50"),children:"grid"===p?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"aspect-square bg-gray-200 flex items-center justify-center",children:[P(e.path)?(0,a.jsx)("img",{src:e.url,alt:e.path,className:"w-full h-full object-cover",onError:e=>{var t;let s=e.target;s.style.display="none",null===(t=s.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}):null,(0,a.jsx)("div",{className:"".concat(P(e.path)?"hidden":""," text-4xl text-gray-400"),children:"\uD83D\uDCC4"})]}),(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.path.split("/").pop()}),(0,a.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.path}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,a.jsx)("button",{onClick:()=>T(e.url),className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200",children:"Copy Path"}),(0,a.jsx)("button",{onClick:()=>v(e.path),className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded hover:bg-red-200",children:"Delete"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center",children:[P(e.path)?(0,a.jsx)("img",{src:e.url,alt:e.path,className:"w-full h-full object-cover rounded-lg",onError:e=>{var t;let s=e.target;s.style.display="none",null===(t=s.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}):null,(0,a.jsx)("div",{className:"".concat(P(e.path)?"hidden":""," text-2xl text-gray-400"),children:"\uD83D\uDCC4"})]})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.path.split("/").pop()}),(0,a.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.path})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T(e.url),className:"bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm hover:bg-blue-200",children:"Copy Path"}),(0,a.jsx)("button",{onClick:()=>v(e.path),className:"bg-red-100 text-red-800 px-3 py-1 rounded text-sm hover:bg-red-200",children:"Delete"})]})]})},t))})})]})}),j&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3 text-center",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,a.jsx)("span",{className:"text-red-600 text-xl",children:"⚠️"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mt-4",children:"Delete Media"}),(0,a.jsxs)("div",{className:"mt-2 px-7 py-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this media file? This action cannot be undone."}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mt-2",children:(0,a.jsx)("code",{children:j})})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4 mt-4",children:[(0,a.jsx)("button",{onClick:()=>v(null),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{let t=e.find(e=>e.path===j);(null==t?void 0:t.sha)&&L(t.path,t.sha)},className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"Delete"})]})]})})})]})}},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=549)}),_N_E=e.O()}]);