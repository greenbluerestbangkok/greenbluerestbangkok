#!/bin/bash

# üéí ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß
# ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß

echo "üéí ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß"
echo "=================================="

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π
show_menu() {
    echo ""
    echo "üìã ‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:"
    echo "1. üìÅ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏£‡∏¥‡∏õ‡πÉ‡∏´‡∏°‡πà"
    echo "2. üñºÔ∏è  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏ó‡∏£‡∏¥‡∏õ"
    echo "3. üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô WebP"
    echo "4. üìä ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ"
    echo "5. üóëÔ∏è  ‡∏•‡∏ö‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ"
    echo "6. ‚ùå ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°"
    echo ""
    read -p "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç (1-6): " choice
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
create_trip_structure() {
    echo ""
    read -p "üìÅ ‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ (1-18): " trip_number
    
    if [[ $trip_number -ge 1 && $trip_number -le 18 ]]; then
        echo "üîÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number..."
        
        mkdir -p "images/webp/trip$trip_number/small"
        mkdir -p "images/webp/trip$trip_number/large"
        
        # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        cp images/webp/logo_001.webp "images/webp/trip$trip_number/small/placeholder.webp"
        cp images/webp/logo_001.webp "images/webp/trip$trip_number/large/placeholder.webp"
        cp images/webp/logo_001.webp "images/webp/trip$trip_number/large/image1.webp"
        cp images/webp/logo_001.webp "images/webp/trip$trip_number/large/image2.webp"
        cp images/webp/logo_001.webp "images/webp/trip$trip_number/large/image3.webp"
        
        echo "‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
    else
        echo "‚ùå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà 1-18"
    fi
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏ó‡∏£‡∏¥‡∏õ
add_trip_image() {
    echo ""
    read -p "üñºÔ∏è  ‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ (1-18): " trip_number
    read -p "üìÅ ‡πÉ‡∏™‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏≤‡∏û (small/large): " image_type
    read -p "üìù ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û (‡πÄ‡∏ä‡πà‡∏ô image1.jpg): " image_name
    
    if [[ $trip_number -ge 1 && $trip_number -le 18 ]]; then
        if [[ "$image_type" == "small" || "$image_type" == "large" ]]; then
            echo "üîÑ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û $image_name ‡πÉ‡∏ô‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number ($image_type)..."
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if [ -f "$image_name" ]; then
                # ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô WebP ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏£‡∏¥‡∏õ
                convert "$image_name" "images/webp/trip$trip_number/$image_type/${image_name%.*}.webp"
                echo "‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏û‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
            else
                echo "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå $image_name ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå"
            fi
        else
            echo "‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà small ‡∏´‡∏£‡∏∑‡∏≠ large"
        fi
    else
        echo "‚ùå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà 1-18"
    fi
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô WebP
convert_to_webp() {
    echo ""
    read -p "üîÑ ‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ (1-18): " trip_number
    
    if [[ $trip_number -ge 1 && $trip_number -le 18 ]]; then
        echo "üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number ‡πÄ‡∏õ‡πá‡∏ô WebP..."
        
        # ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå small
        if [ -d "images/webp/trip$trip_number/small" ]; then
            for img in images/webp/trip$trip_number/small/*.{jpg,jpeg,png}; do
                if [ -f "$img" ]; then
                    echo "üîÑ ‡πÅ‡∏õ‡∏•‡∏á: $img"
                    convert "$img" "${img%.*}.webp"
                fi
            done
        fi
        
        # ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå large
        if [ -d "images/webp/trip$trip_number/large" ]; then
            for img in images/webp/trip$trip_number/large/*.{jpg,jpeg,png}; do
                if [ -f "$img" ]; then
                    echo "üîÑ ‡πÅ‡∏õ‡∏•‡∏á: $img"
                    convert "$img" "${img%.*}.webp"
                fi
            done
        fi
        
        echo "‚úÖ ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏û‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
    else
        echo "‚ùå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà 1-18"
    fi
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ
show_trip_status() {
    echo ""
    read -p "üìä ‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ (1-18) ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà 'all' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: " trip_number
    
    if [[ "$trip_number" == "all" ]]; then
        echo "üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:"
        echo "=================================="
        
        for i in {1..18}; do
            small_count=$(ls -1 "images/webp/trip$i/small/"*.webp 2>/dev/null | wc -l)
            large_count=$(ls -1 "images/webp/trip$i/large/"*.webp 2>/dev/null | wc -l)
            
            printf "‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà %2d: Small: %2d ‡πÑ‡∏ü‡∏•‡πå, Large: %2d ‡πÑ‡∏ü‡∏•‡πå\n" $i $small_count $large_count
        done
    elif [[ $trip_number -ge 1 && $trip_number -le 18 ]]; then
        echo "üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number:"
        echo "=================================="
        
        if [ -d "images/webp/trip$trip_number" ]; then
            echo "üìÅ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Small:"
            ls -la "images/webp/trip$trip_number/small/" 2>/dev/null || echo "   ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå"
            
            echo ""
            echo "üìÅ ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Large:"
            ls -la "images/webp/trip$trip_number/large/" 2>/dev/null || echo "   ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå"
        else
            echo "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏£‡∏¥‡∏õ‡∏ó‡∏µ‡πà $trip_number"
        fi
    else
        echo "‚ùå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
    fi
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏†‡∏≤‡∏û‡∏ó‡∏£‡∏¥‡∏õ
delete_trip_image() {
    echo ""
    read -p "üóëÔ∏è  ‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ (1-18): " trip_number
    read -p "üìÅ ‡πÉ‡∏™‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏≤‡∏û (small/large): " image_type
    read -p "üìù ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û (‡πÄ‡∏ä‡πà‡∏ô image1.webp): " image_name
    
    if [[ $trip_number -ge 1 && $trip_number -le 18 ]]; then
        if [[ "$image_type" == "small" || "$image_type" == "large" ]]; then
            image_path="images/webp/trip$trip_number/$image_type/$image_name"
            
            if [ -f "$image_path" ]; then
                echo "üóëÔ∏è  ‡∏•‡∏ö‡∏†‡∏≤‡∏û: $image_path"
                rm "$image_path"
                echo "‚úÖ ‡∏•‡∏ö‡∏†‡∏≤‡∏û‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
            else
                echo "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå $image_path"
            fi
        else
            echo "‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà small ‡∏´‡∏£‡∏∑‡∏≠ large"
        fi
    else
        echo "‚ùå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà 1-18"
    fi
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å
main() {
    while true; do
        show_menu
        
        case $choice in
            1)
                create_trip_structure
                ;;
            2)
                add_trip_image
                ;;
            3)
                convert_to_webp
                ;;
            4)
                show_trip_status
                ;;
            5)
                delete_trip_image
                ;;
            6)
                echo "üëã ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ!"
                exit 0
                ;;
            *)
                echo "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 1-6"
                ;;
        esac
        
        echo ""
        read -p "‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å..."
    done
}

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°
main
