#!/bin/bash

# üîç ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
# ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î HTML, CSS, ‡πÅ‡∏•‡∏∞ JavaScript

echo "üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û..."
echo "======================================"

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô HTML
echo "üìÑ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô HTML..."

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå HTML ‡∏´‡∏•‡∏±‡∏Å
html_files=("index.html" "pages/*.html")

for pattern in "${html_files[@]}"; do
    for file in $pattern; do
        if [ -f "$file" ]; then
            echo "üìÅ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå: $file"
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .jpg, .png, .jpeg
            old_refs=$(grep -o 'src="[^"]*\.\(jpg\|png\|jpeg\)"' "$file" | wc -l | tr -d ' ')
            if [ $old_refs -gt 0 ]; then
                echo "   ‚ö†Ô∏è ‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤: $old_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                grep -o 'src="[^"]*\.\(jpg\|png\|jpeg\)"' "$file" | head -5
                if [ $old_refs -gt 5 ]; then
                    echo "   ... ‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡∏Å $(($old_refs - 5)) ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                fi
            else
                echo "   ‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤"
            fi
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .webp
            webp_refs=$(grep -o 'src="[^"]*\.webp"' "$file" | wc -l | tr -d ' ')
            echo "   üìä ‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û WebP: $webp_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
        fi
    done
done

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô CSS
echo ""
echo "üé® ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô CSS..."

css_files=("css/*.css")

for pattern in "${css_files[@]}"; do
    for file in $pattern; do
        if [ -f "$file" ]; then
            echo "üìÅ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå: $file"
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .jpg, .png, .jpeg
            old_refs=$(grep -o 'url([^)]*\.\(jpg\|png\|jpeg\))' "$file" | wc -l | tr -d ' ')
            if [ $old_refs -gt 0 ]; then
                echo "   ‚ö†Ô∏è ‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤: $old_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                grep -o 'url([^)]*\.\(jpg\|png\|jpeg\))' "$file" | head -3
                if [ $old_refs -gt 3 ]; then
                    echo "   ... ‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡∏Å $(($old_refs - 3)) ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                fi
            else
                echo "   ‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤"
            fi
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .webp
            webp_refs=$(grep -o 'url([^)]*\.webp)' "$file" | wc -l | tr -d ' ')
            echo "   üìä ‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û WebP: $webp_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
        fi
    done
done

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô JavaScript
echo ""
echo "‚öôÔ∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô JavaScript..."

js_files=("js/*.js")

for pattern in "${js_files[@]}"; do
    for file in $pattern; do
        if [ -f "$file" ]; then
            echo "üìÅ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå: $file"
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .jpg, .png, .jpeg
            old_refs=$(grep -o '["'"'"'][^"'"'"']*\.\(jpg\|png\|jpeg\)["'"'"']' "$file" | wc -l | tr -d ' ')
            if [ $old_refs -gt 0 ]; then
                echo "   ‚ö†Ô∏è ‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤: $old_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                grep -o '["'"'"'][^"'"'"']*\.\(jpg\|png\|jpeg\)["'"'"']' "$file" | head -3
                if [ $old_refs -gt 3 ]; then
                    echo "   ... ‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡∏Å $(($old_refs - 3)) ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
                fi
            else
                echo "   ‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤"
            fi
            
            # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û .webp
            webp_refs=$(grep -o '["'"'"'][^"'"'"']*\.webp["'"'"']' "$file" | wc -l | tr -d ' ')
            echo "   üìä ‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û WebP: $webp_refs ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
        fi
    done
done

# ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ
echo ""
echo "üéâ ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!"
echo "======================================"
echo "üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:"
echo "   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏ô HTML"
echo "   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏ô CSS"
echo "   ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏ô JavaScript"
echo ""
echo "üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:"
echo "   - ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤ ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô .webp"
echo "   - ‡πÉ‡∏ä‡πâ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå update-all-to-webp.sh ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
echo "   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï"
