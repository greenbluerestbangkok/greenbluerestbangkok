#!/bin/bash

# ЁЯЦ╝я╕П р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
# р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Ар╕зр╣Зр╕Ър╣Др╕Лр╕Хр╣М

echo "ЁЯЦ╝я╕П р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю..."
echo "======================================"

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
echo "ЁЯУБ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю..."

if [ -d "images" ]; then
    echo "тЬЕ р╕Юр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М images/"
    echo "   ЁЯУК р╕Ир╕│р╕Щр╕зр╕Щр╣Др╕Яр╕ер╣М: $(find images -type f | wc -l | tr -d ' ')"
fi

if [ -d "images/webp" ]; then
    echo "тЬЕ р╕Юр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М images/webp/"
    echo "   ЁЯУК р╕Ир╕│р╕Щр╕зр╕Щр╣Др╕Яр╕ер╣М: $(find images/webp -type f | wc -l | tr -d ' ')"
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Лр╣Йр╕│р╕Лр╣Йр╕нр╕Щ
echo ""
echo "ЁЯФН р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Лр╣Йр╕│р╕Лр╣Йр╕нр╕Щ..."

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М operators
if [ -d "images/operators" ] && [ -d "images/webp/operators" ]; then
    echo "ЁЯУВ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М operators..."
    
    # р╕Щр╕▒р╕Ър╕Ир╕│р╕Щр╕зр╕Щр╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М
    old_count=$(find images/operators -type f | wc -l | tr -d ' ')
    new_count=$(find images/webp/operators -type f | wc -l | tr -d ' ')
    
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Бр╣Ир╕▓: $old_count р╣Др╕Яр╕ер╣М"
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕лр╕бр╣И (WebP): $new_count р╣Др╕Яр╕ер╣М"
    
    if [ $old_count -gt 0 ] && [ $new_count -gt 0 ]; then
        echo "   тЪая╕П р╕Юр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Чр╕▒р╣Йр╕Зр╣Бр╕Ър╕Ър╣Ар╕Бр╣Ир╕▓р╣Бр╕ер╕░р╣Гр╕лр╕бр╣И"
        echo "   ЁЯТб р╣Бр╕Щр╕░р╕Щр╕│: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕ер╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Бр╣Ир╕▓р╕лр╕гр╕╖р╕нр╣Др╕бр╣И"
    fi
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М products
if [ -d "images/products" ] && [ -d "images/webp/products" ]; then
    echo "ЁЯУВ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М products..."
    
    old_count=$(find images/products -type f | wc -l | tr -d ' ')
    new_count=$(find images/webp/products -type f | wc -l | tr -d ' ')
    
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Бр╣Ир╕▓: $old_count р╣Др╕Яр╕ер╣М"
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕лр╕бр╣И (WebP): $new_count р╣Др╕Яр╕ер╣М"
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М blog
if [ -d "images/blog" ] && [ -d "images/webp/blog" ]; then
    echo "ЁЯУВ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М blog..."
    
    old_count=$(find images/blog -type f | wc -l | tr -d ' ')
    new_count=$(find images/webp/blog -type f | wc -l | tr -d ' ')
    
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Бр╣Ир╕▓: $old_count р╣Др╕Яр╕ер╣М"
    echo "   ЁЯУК р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕лр╕бр╣И (WebP): $new_count р╣Др╕Яр╕ер╣М"
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М trips
echo "ЁЯУВ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М trips..."
trip_dirs=$(find images -type d -name "trip*" | wc -l | tr -d ' ')
webp_trip_dirs=$(find images/webp -type d -name "trip*" | wc -l | tr -d ' ')

echo "   ЁЯУК р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М trip р╣Ар╕Бр╣Ир╕▓: $trip_dirs р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М"
echo "   ЁЯУК р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М trip р╣Гр╕лр╕бр╣И: $webp_trip_dirs р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М"

# р╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ы
echo ""
echo "ЁЯОЙ р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ!"
echo "======================================"
echo "ЁЯУК р╕кр╕гр╕╕р╕Ыр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ:"
echo "   тЬЕ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М"
echo "   тЬЕ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Лр╣Йр╕│р╕Лр╣Йр╕нр╕Щ"
echo "   тЬЕ р╕Щр╕▒р╕Ър╕Ир╕│р╕Щр╕зр╕Щр╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Бр╕Хр╣Ир╕ер╕░р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М"
echo ""
echo "ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│:"
echo "   - р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕ер╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Бр╣Ир╕▓: ./scripts/remove-old-images.sh"
echo "   - р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Ыр╕ер╕Зр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Ар╕Ыр╣Зр╕Щ WebP: ./scripts/convert-to-webp.sh"
echo "   - р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З: ./scripts/check-image-references.sh"
